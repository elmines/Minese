program : definition
        | definition program

definition : classDef
           | varDef


classDef : CLASS IDENTIFIER optExtension OCURLY classBody CCURLY

optExtension : NONE
             | EXTENDS IDENTIFIER

classBody : varDef
          | varDef classBody



varDef : VAR IDENTIFIER optAssignment SEMICOLON
       | functionDef

optAssignment : NONE
              | ASSIGN expression



functionDef : DEFINE IDENTIFIER functionSig block

functionSig : OPAREN optParamsList CPAREN

optParamsList : NONE
              | paramsList

paramsList : VAR IDENTIFIER
           | VAR IDENTIFIER COMMA paramsList

block : OCURLY optStatements CCURLY
      | statement




optStatements : NONE
              | statements

statements : statement
           | statement statements

statement : condBlock
          | whileBlock
          | expression  SEMICOLON
          | definition
          | returnStatement


condStatement : IF condition block |
              : IF condition block ELSE block

whileHeader : WHILE condition block

condition : OPAREN expression CPAREN

returnStatement : RETURN expression SEMICOLON
                | RETURN SEMICOLON




expression : unary
           | unary operator expression

unary: UMINUS unary
     | OPAREN expression CPAREN
     | functionCall
     | array
     | arrayElement
     | lambda
     | IDENTIFIER
     | boolean
     | INTEGER
     | STRING

functionCall : unary OPAREN optExprList CPAREN

optExprList : NONE
            | exprList

exprList : expression
         | expression COMMA exprList

array : OCURLY exprList CCURLY

arrayElement : IDENTIFIER OBRACK expression CBRACK

lambda : functionSig block

boolean : TRUE
        | FALSE

operator : PLUS
         | TIMES
         | MINUS
         | DIV
         | MOD
         | LT
         | LTE
	 | NEQ
         | EQ
         | GTE
         | GT
         | ASSIGN
         | DOT
         | AND
         | OR
         | NOT
